## 代理模式 Proxy Pattern

### 定义

给某一个对象提供一个代理或占位符，并由代理对象来控制对原对象的访问。

代理模式是一种对象结构型模式，在客户端对象和目标对象之间起到中介作用，去掉客户端不能看到的内容，增添客户端需要的额外的新服务。

### 角色 

1.Subject:抽象主题，声明真实主题和代理主题的共同接口，客户端针对抽象主题进行编程。
```java
abstract class Subject{
    public abstract void Request();
}
```
2.Proxy:代理主题；包含对真实主题的引用，提供与真实主题相同的接口，方便在任何时候替代真实主题；可以在调用真实主题操作前执行其他操作。
```java
class Proxy extends Subject{
    private RealSubject realSubject = new RealSubject();
    public void PreRequest(){}
    public void Request(){
        PreRequest();
        realSubject.Request();
        PostRequest();
    }
    public void PostRequest(){}
}
```
3.RealSubject:真实主题，实现了真实的业务操作，客户端可以通过代理主题间接调用真实主题中定义的操作。
```java
class RealSubject extends Subject{
    public void Request(){//业务方法具体实现}
}
```

### 分类

#### 远程代理 Remote Proxy

为一个位于不同地址空间的对象提供一个本地的代理对象，不同的地址空间可以是同一台/不同台主机。

远程代理对象可以隐藏网络细节，承担大部分的网络通信工作，并负责对远程业务方法的调用。

可以将消耗资源较多的对象和操作移到性能更好的计算机上，提高系统的整体运行效率。

当客户端要访问远程主机中的对象时可以使用远程代理。

#### 虚拟代理 Virtual Proxy

创建消耗比较小的代理对象，需要时使用代理对象创建资源消耗较大/加载时间较长的真正对象。

在程序启动时，结合多线程技术，一个线程用于显示代理对象，其他线程用于加载真实对象，此时用代理对象代替真实对象初始化，加速系统的启动时间；当需要使用真实对象时，用代理对象来引用，此时真实对象已成功加载完毕，缩短用户等待时间。

当真实对象的加载十分耗费系统资源时，虚拟代理可以让真实对象推迟到需要使用时再创建，并且真实对象可被多次重用，每次访问时需要进行存在性检测。--用时间换空间

#### 保护代理 Protect Proxy

控制对真实主题的访问，给不同用户提供不同级别的使用权限。

#### 缓冲代理 Cache Proxy

给某一个目标操作的结果提供临时的存储空间，方便多个客户端共享结果。

可以优化系统性能，缩短执行时间。

#### 智能引用代理 Smart Reference Proxy

当真实对象被引用时提供额外的操作，比如：记录真实对象被调用的次数。

### 优点

1.能够协调调用者和被调用者，在一定程度上降低系统的耦合度。

2.客户端针对抽象主题进行编程，增加和更换代理类无须修改源代码，符合“开闭原则”，系统有较好的灵活性和可扩展性。

### 缺点

1.保护代理等代理模式可能会造成请求的处理速度变慢。

2.远程代理等代理模式的实现过程可能较为复杂。

### 思考题

1.Windows操作系统中应用程序快捷方式是代理模式的应用实例。

